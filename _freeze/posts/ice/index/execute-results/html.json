{
  "hash": "adfe6d94a67b322ba2ea27ef23429887",
  "result": {
    "markdown": "---\ntitle: \"Cold as ICE\"\nauthor: \"Jakob Prossliner\"\ndate: \"2023-12-10\"\ncategories: [futures]\nimage: \"image.jpg\"\nformat:\n  html:\n    code-fold: true\n    page-layout: full\n\nmessage: false\nwarning: false\nexecute:\n  freeze: auto\nengine: knitr\n---\n\n\n# ICE data\n\nRecently I managed to understand the way the (unofficial) API of the Intercontinental exchange works,\ngiving access to very interesting futures data.\nThis way we can make some interesting analysis - lets start by simply calculating dark, spark spreads.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ospowertrader)\n\n# get the data\nproducts <- list(\n  api2_coal = list(\n    productId = 517,\n    hubId     = 681,\n    desc = \"api2\"\n  ),\n  ttf_gas = list(\n    productId = 4331,\n    hubId     = 7979,\n    desc = \"ttf\"\n  ),\n  brent_crude = list(\n    productId = 254,\n    hubId     = 403,\n    desc = \"brent\"\n  ),\n  german_power = list(\n    productId = 19032,\n    hubId     = 21971,\n    desc = \"german_power_base\"\n  ),\n  eua = list(\n    productId = 390,\n    hubId     = 564,\n    desc = \"eua\"\n  )\n)\n\ndf <- tibble(products) %>% \n  unnest_wider(products)\n\n\ndf <- df %>% \n  mutate(data = map2(.x = productId, .y = hubId, ~ice_futures_list(productId = .x, hubId = .y))) %>% \n  unnest(data)\n\n\nprice_table <- df %>%\n  select(desc, marketStrip, lastPrice) %>% \n  pivot_wider(names_from = desc, values_from = lastPrice)\n\nknitr::kable(price_table)\n```\n\n::: {.cell-output-display}\n|marketStrip |   api2|    ttf| brent| german_power_base|   eua|\n|:-----------|------:|------:|-----:|-----------------:|-----:|\n|Dec23       | 123.00|     NA|    NA|                NA| 68.62|\n|Jan24       | 118.25| 38.840|    NA|             94.32| 69.35|\n|Feb24       | 113.75| 39.345| 75.65|            101.61|    NA|\n|Q1 24       | 114.00| 39.205|    NA|             95.48|    NA|\n|Mar24       | 110.50| 39.290| 75.80|             90.89| 69.40|\n|Apr24       | 110.50| 38.860| 75.82|                NA|    NA|\n|May24       |     NA| 38.410| 75.80|                NA|    NA|\n|Q2 24       | 110.50| 38.695|    NA|                NA|    NA|\n|Jun24       |     NA| 38.595| 75.73|                NA|    NA|\n|Jul24       |     NA| 38.590| 75.63|                NA|    NA|\n|Aug24       |     NA| 38.610| 75.47|                NA|    NA|\n|Q3 24       | 112.00| 38.670|    NA|                NA|    NA|\n|Sep24       |     NA| 38.890| 75.27|                NA|    NA|\n|Oct24       |     NA| 39.715| 75.37|                NA|    NA|\n|Nov24       |     NA| 42.640| 75.13|                NA|    NA|\n|Cal 24      | 112.15| 39.500|    NA|                NA|    NA|\n|Q4 24       | 114.00| 42.285|    NA|            112.37|    NA|\n|Dec24       |     NA| 44.270| 74.60|                NA| 71.61|\n|Summer24    |     NA| 38.650|    NA|                NA|    NA|\n|Jan25       |     NA| 44.275| 74.64|                NA|    NA|\n|Feb25       |     NA| 43.500| 73.94|                NA|    NA|\n|Winter24    |     NA| 43.035|    NA|                NA|    NA|\n|Q1 25       |     NA| 43.800|    NA|                NA|    NA|\n|Mar25       |     NA|     NA|    NA|                NA| 72.61|\n|Apr25       |     NA|     NA|    NA|                NA|    NA|\n|May25       |     NA| 37.375|    NA|                NA|    NA|\n|Q2 25       |     NA| 37.800|    NA|                NA|    NA|\n|Jun25       |     NA| 37.350| 73.22|                NA|    NA|\n|Jul25       |     NA|     NA|    NA|                NA|    NA|\n|Aug25       |     NA|     NA|    NA|                NA|    NA|\n|Summer25    |     NA| 37.360|    NA|                NA|    NA|\n|Q3 25       |     NA| 36.810|    NA|                NA|    NA|\n|Sep25       |     NA|     NA|    NA|                NA|    NA|\n|Oct25       |     NA|     NA|    NA|                NA|    NA|\n|Nov25       |     NA|     NA|    NA|                NA|    NA|\n|Cal 25      |     NA| 39.300|    NA|             98.88|    NA|\n|Q4 25       |     NA| 38.800|    NA|                NA|    NA|\n|Dec25       |     NA|     NA| 72.06|                NA| 74.41|\n|Jan26       |     NA|     NA|    NA|                NA|    NA|\n|Feb26       |     NA|     NA|    NA|                NA|    NA|\n|Winter25    |     NA| 39.100|    NA|                NA|    NA|\n|Q1 26       |     NA|     NA|    NA|                NA|    NA|\n|Mar26       |     NA|     NA|    NA|                NA| 75.46|\n|Apr26       |     NA|     NA|    NA|                NA|    NA|\n|May26       |     NA|     NA|    NA|                NA|    NA|\n|Jun26       |     NA|     NA| 71.10|                NA|    NA|\n|Jul26       |     NA|     NA|    NA|                NA|    NA|\n|Aug26       |     NA|     NA|    NA|                NA|    NA|\n|Summer26    |     NA| 32.450|    NA|                NA|    NA|\n|Sep26       |     NA|     NA|    NA|                NA|    NA|\n|Oct26       |     NA|     NA|    NA|                NA|    NA|\n|Nov26       |     NA|     NA|    NA|                NA|    NA|\n|Cal 26      |     NA| 34.500|    NA|                NA|    NA|\n|Dec26       |     NA|     NA| 70.22|                NA| 77.25|\n|Jan27       |     NA|     NA|    NA|                NA|    NA|\n|Feb27       |     NA|     NA|    NA|                NA|    NA|\n|Winter26    |     NA| 34.400|    NA|                NA|    NA|\n|Mar27       |     NA|     NA|    NA|                NA|    NA|\n|Jun27       |     NA|     NA|    NA|                NA|    NA|\n|Dec27       |     NA|     NA| 69.65|                NA|    NA|\n|Dec28       |     NA|     NA|    NA|                NA|    NA|\n:::\n:::\n\n\nSo we can see there are different market strips to consider. Unfortunately we cannot determine the value for all spreads,\nsince not all last prices are published for each product.\n\n#### Conversion table:\n\n##### Assumptions:\n\n- coal plant:\n  - 1 MWh of thermal energy in 0.1228 tonnes of coal\n  - coal plant efficiency is 37 %\n  - with a CO2 output of 0.34 tonnes\n\n- single cycle gas:\n  - 40% efficiency \n  - 0.2 tonnes of CO2 output\n\n- combined cycle (ccgt): \n  - 60% efficiency \n  - with 0.2 tonnes of CO2 output\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspread <- function(fuel_cost, efficiency, power){\n  spark_spread <- power - (fuel_cost/efficiency)\n  # spred         # revenue # cost\n  return(spark_spread)\n}\n\nclean_spread <- function(fuel_cost, efficiency, power, co2_mwh, co2_price){\n  clean_spread <- power - ((fuel_cost / efficiency) + co2_mwh * co2_price)\n  return(clean_spread)\n}\n\nprice_table %>% \n  mutate(\n    spark = spread(ttf, 0.40, german_power_base),\n    dark  = spread(api2 * 0.1228, 0.37, german_power_base),\n    spark_ccgt = spread(ttf, 0.6, german_power_base),\n    clean_spark = clean_spread(ttf, 0.40, german_power_base, 0.2, eua),\n    clean_dark = clean_spread(api2 * 0.1228, 0.37, german_power_base, 0.34, eua),\n    clean_spark_ccgt = clean_spread(ttf, 0.6, german_power_base, 0.2, eua)\n    ) %>% \n  filter(!is.na(german_power_base)) %>% \n  mutate(across(where(is.numeric), ~round(., digits = 2))) %>% \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|marketStrip |   api2|   ttf| brent| german_power_base|   eua| spark|  dark| spark_ccgt| clean_spark| clean_dark| clean_spark_ccgt|\n|:-----------|------:|-----:|-----:|-----------------:|-----:|-----:|-----:|----------:|-----------:|----------:|----------------:|\n|Jan24       | 118.25| 38.84|    NA|             94.32| 69.35| -2.78| 55.07|      29.59|      -16.65|      31.49|            15.72|\n|Feb24       | 113.75| 39.34| 75.65|            101.61|    NA|  3.25| 63.86|      36.03|          NA|         NA|               NA|\n|Q1 24       | 114.00| 39.20|    NA|             95.48|    NA| -2.53| 57.64|      30.14|          NA|         NA|               NA|\n|Mar24       | 110.50| 39.29| 75.80|             90.89| 69.40| -7.33| 54.22|      25.41|      -21.21|      30.62|            11.53|\n|Q4 24       | 114.00| 42.28|    NA|            112.37|    NA|  6.66| 74.53|      41.90|          NA|         NA|               NA|\n|Cal 25      |     NA| 39.30|    NA|             98.88|    NA|  0.63|    NA|      33.38|          NA|         NA|               NA|\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}